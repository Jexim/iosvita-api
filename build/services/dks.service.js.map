{"version":3,"sources":["../../src/services/dks.service.js"],"names":["doc","GoogleSpreadsheet","appConfig","process","env","NODE_ENV","googleSheetId","list","database","Dk","findAll","parseFromDocs","Promise","resolve","reject","getInfo","error","info","sheet","worksheets","find","item","title","getRows","rows","createdDks","destroy","where","dkRow","newDk","id","number","console","log","create","push"],"mappings":";;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AAEA,IAAMA,GAAG,GAAG,IAAIC,6BAAJ,CAAsBC,gBAAUC,OAAO,CAACC,GAAR,CAAYC,QAAZ,IAAwB,aAAlC,EAAiDC,aAAvE,CAAZ;;SAEsBC,I;;;;;;;+BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEUC,mBAASC,EAAT,CAAYC,OAAZ,EAFV;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;SAQeC,a;;;;;;;+BAAf;AAAA;AAAA;AAAA;AAAA;AAAA,8CACE,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCd,cAAAA,GAAG,CAACe,OAAJ,CAAY,UAASC,KAAT,EAAgBC,IAAhB,EAAsB;AAChC,oBAAID,KAAJ,EAAW,OAAOF,MAAM,CAACE,KAAD,CAAb;AACX,oBAAME,KAAK,GAAGD,IAAI,CAACE,UAAL,CAAgBC,IAAhB,CAAqB,UAAAC,IAAI;AAAA,yBAAIA,IAAI,CAACC,KAAL,KAAe,IAAnB;AAAA,iBAAzB,CAAd;AAEAJ,gBAAAA,KAAK,CAACK,OAAN,CAAc,EAAd;AAAA;AAAA;AAAA;AAAA;AAAA,+CAAkB,kBAAOP,KAAP,EAAcQ,IAAd;AAAA;;AAAA;AAAA;AAAA;AAAA;AAChB,gCAAIR,KAAJ,EAAWF,MAAM,CAACE,KAAD,CAAN;AAELS,4BAAAA,UAHU,GAGG,EAHH;AAAA;AAAA;AAAA,mCAMRjB,mBAASC,EAAT,CAAYiB,OAAZ,CAAoB;AAAEC,8BAAAA,KAAK,EAAE;AAAT,6BAApB,CANQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCAQMH,IARN;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAQHI,4BAAAA,KARG;AASNC,4BAAAA,KATM,GASE;AACZC,8BAAAA,EAAE,EAAEF,KAAK,CAACG,MADE;AAEZT,8BAAAA,KAAK,EAAEM,KAAK,CAACN;AAFD,6BATF;AAaZU,4BAAAA,OAAO,CAACC,GAAR,CAAYJ,KAAZ;AAbY;AAAA,mCAeNrB,mBAASC,EAAT,CAAYyB,MAAZ,CAAmBL,KAAnB,CAfM;;AAAA;AAgBZJ,4BAAAA,UAAU,CAACU,IAAX,CAAgBN,KAAhB;;AAhBY;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAkBdhB,4BAAAA,OAAO,CAACY,UAAD,CAAP;AAlBc;AAAA;;AAAA;AAAA;AAAA;AAoBdX,4BAAAA,MAAM,cAAN;;AApBc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAlB;;AAAA;AAAA;AAAA;AAAA;AAuBD,eA3BD;AA4BD,aA7BM,CADF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import GoogleSpreadsheet from \"google-spreadsheet\";\nimport database from \"../models\";\nimport appConfig from \"../../config/app\";\n\nconst doc = new GoogleSpreadsheet(appConfig[process.env.NODE_ENV || \"development\"].googleSheetId);\n\nexport async function list() {\n  try {\n    return await database.Dk.findAll();\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport async function parseFromDocs() {\n  return new Promise((resolve, reject) => {\n    doc.getInfo(function(error, info) {\n      if (error) return reject(error);\n      const sheet = info.worksheets.find(item => item.title === \"DK\");\n\n      sheet.getRows({}, async (error, rows) => {\n        if (error) reject(error);\n\n        const createdDks = [];\n        \n        try {\n          await database.Dk.destroy({ where: {} });\n\n          for (const dkRow of rows) {\n            const newDk = {\n              id: dkRow.number,\n              title: dkRow.title\n            };\n            console.log(newDk);\n\n            await database.Dk.create(newDk);\n            createdDks.push(newDk);\n          }\n          resolve(createdDks);\n        } catch (error) {\n          reject(error);\n        }\n      });\n    });\n  });\n}"],"file":"dks.service.js"}